!function(){"use strict";var n=function(n){n="object"==typeof n?n:{},this.author=n.author||"Sergey Zhitenev",this.canvas=document.getElementById(n.canvasId),this.context=this.canvas.getContext("2d"),this.offsetX=0,this.offsetY=0,this.channels=[],this.versions=[],this.channelsColors=["#979797","#008fb5","#f1c109"],this.padding=20},t=function(n){n="object"==typeof n?n:{},this.name=n.name,this.channels=n.channels,this.next=n.next,this.prev=n.prev,this.point=n.point,this.x=n.x,this.y=n.y},e=function(n){n="object"==typeof n?n:{},this.id=n.id,this.name=n.name};n.prototype.newChannel=function(n){n="object"==typeof n?n:{};var t=new e(n);this.channels.push(t)},n.prototype.newVersion=function(n){n="object"==typeof n?n:{},n.parent=this,n.name=n.name||" ",n.channels=n.channels||[],n.next=n.next||[],n.prev=n.prev||[],n.point=n.point||[];var e=new t(n);this.versions.push(e)},n.prototype.calculatePositions=function(n){var t=this.padding,e=function(){var t,e=[],o={},i=null,s=0;for(t=0;t<n.length;t+=1)for(i=n[t].parent,n[t].parent=null,s=0;s<n[t].channels.length;s+=1)o=JSON.parse(JSON.stringify(n[t])),o.channelId=o.channels[s].id,o.channelName=o.channels[s].name,o.published=o.channels[s].published,o.parent=i,delete o.channels,e.push(o);return e.sort(function(n,t){return new Date(n.published)-new Date(t.published)}),e},o=function(n){return n.map(function(n,e){return n.point.y=50*e+t,n})},i=function(n,t){var e=t;return n.map(function(n){var t;for(t=0;t<e.length;t+=1)if(n.channelName==e[t].name)return n.point.x=e[t].x,n.point.color=e[t].color,n})},s=e(n);return s=o(s),s=i(s,this.channels)},n.prototype.styleChannels=function(n,t){var e=this.padding;return n.map(function(n,o){return n.color=t[o],n.x=100*o+e,n})},n.prototype.calculateWindowSize=function(n){this.canvas.height=50*n.length},n.prototype.drawEdge=function(n,t){console.log("______________",n,t)},n.prototype.render=function(){var n=this;this.channels=this.styleChannels(this.channels,this.channelsColors);var t=this.calculatePositions(this.versions);this.calculateWindowSize(t),t.map(function(t){n.context.beginPath(),n.context.arc(t.point.x,t.point.y,6,0,2*Math.PI,!1),n.context.fillStyle=t.point.color,n.context.strokeStyle=t.point.color,n.context.lineWidth=1,n.context.stroke(),n.context.fill(),n.context.closePath()});var e,o;for(e=0;e<t.length;e+=1)for(o=e;o<t.length-1;o+=1)this.drawEdge(t[e],t[o])},"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=n:(window.VCSGraph=n,window.VCSGraph.version=t)}();